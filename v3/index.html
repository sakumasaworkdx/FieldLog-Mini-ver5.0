<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <link rel="manifest" href="data:application/manifest+json,{%22name%22:%22FieldLog%22,%22short_name%22:%22FieldLog%22,%22start_url%22:%22./%22,%22display%22:%22standalone%22}">
  <title>FieldLog v6.5</title>
  <style>
    body { background:#000; color:#fff; font-family:sans-serif; margin:0; padding:10px; }
    .card { background:#111; border:1px solid #333; padding:15px; border-radius:12px; margin-bottom:15px; }
    .btn-main { width:100%; border-radius:12px; border:none; color:white; cursor:pointer; display:flex; align-items:center; justify-content:center; margin-bottom:12px; font-weight:bold; }
    .photo-btn { background:#00bb55; height:100px; font-size:20px; }
    .geo-btn { background:#007bff; height:85px; font-size:18px; }
    .btn-save { background:#dc3545; height:90px; font-size:24px; }
    .geo-info-box { background:#000; color:#0f0; padding:15px; border-radius:8px; font-family:monospace; line-height:1.6; border:1px solid #333; margin-bottom:15px; }
    .input-field { width:100%; background:#222; color:#fff; border:1px solid #444; padding:14px; border-radius:8px; margin-bottom:10px; font-size:16px; box-sizing:border-box; }
    table { width:100%; border-collapse:collapse; font-size:12px; }
    td { padding:10px; border-bottom:1px solid #333; }
    summary { cursor:pointer; color:#aaa; padding:5px; }
  </style>
</head>
<body>
  <main style="max-width:500px; margin:0 auto;">
    <details class="card">
      <summary>âš™ï¸ CSVèª­è¾¼ (A:åœ°ç‚¹, B:å°åŒºåˆ†, C:é …ç›®)</summary>
      <input id="listCsvInput" type="file" accept=".csv" style="width:100%; margin-top:10px;">
    </details>

    <section class="card">
      <label class="btn-main photo-btn">
        <input id="photoInput" type="file" accept="image/*" capture="environment" style="display:none;">
        <span style="font-size:35px; margin-right:15px;">ğŸ“·</span> å†™çœŸã‚’æ’®ã‚‹ <span id="photoCheck"></span>
      </label>
      <button id="btnGeo" class="btn-main geo-btn" type="button">
        <span style="font-size:30px; margin-right:15px;">ğŸ“</span> ä½ç½®ãƒ»æ–¹ä½ã‚’è¨˜éŒ² <span id="geoCheck"></span>
      </button>
      <div id="previewContainer" style="text-align:center; display:none; margin-bottom:15px;"><img id="imgPreview" style="max-width:100%; border-radius:8px;"></div>
      <div class="geo-info-box">ç·¯åº¦: <span id="lat">-</span><br>çµŒåº¦: <span id="lng">-</span><br>æ–¹ä½: <span id="heading">-</span></div>
      <select id="selLocation" class="input-field"><option value="">åœ°ç‚¹ã‚’é¸æŠ</option></select>
      <select id="selSubLocation" class="input-field"><option value="">å°åŒºåˆ†ã‚’é¸æŠ</option></select>
      <select id="selItem" class="input-field"><option value="">é …ç›®ã‚’é¸æŠ</option></select>
      <textarea id="memo" class="input-field" style="height:80px;" placeholder="å‚™è€ƒ"></textarea>
      <button id="btnSave" class="btn-save btn-main">ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜</button>
    </section>

    <section class="card">
      <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
        <button id="btnDownloadAll" style="background:#007bff; color:white; border:none; padding:12px; border-radius:8px; font-weight:bold;">ğŸ“¦ ä¸€æ‹¬ZIPä¿å­˜</button>
        <button id="btnDeleteAll" style="background:#600; color:white; border:none; padding:12px; border-radius:8px;">âš ï¸ å…¨å‰Šé™¤</button>
      </div>
      <table id="list"></table>
    </section>
  </main>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js').then(reg => {
        reg.onupdatefound = () => {
          const installingWorker = reg.installing;
          installingWorker.onstatechange = () => {
            if (installingWorker.state === 'installed' && navigator.serviceWorker.controller) {
              alert("æœ€æ–°ç‰ˆã«æ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚å†èµ·å‹•ã—ã¦ãã ã•ã„ã€‚");
            }
          };
        };
      });
    }
  </script>
  <script src="./app.js"></script>
</body>
</html>
